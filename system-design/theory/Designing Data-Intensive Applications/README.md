##	Progress
###	1 / 12

- [Часть I – основы информационных систем](#часть-i--основы-информационных-систем)
  - [Глава 1 – Надежные, масштабируемые и удобные в сопровождении приложения](#глава-1--надежные-масштабируемые-и-удобные-в-сопровождении-приложения)
    - [1.2 Надежность](#12-надежность)
      - [Человеческий фактор](#человеческий-фактор)
    - [1.3 Масштабируемость](#13-масштабируемость)
      - [Описание нагрузки](#описание-нагрузки)
      - [Описание производительности](#описание-производительности)
        - [latency (время ожидания) vs response time (время отклика)](#latency-время-ожидания-vs-response-time-время-отклика)
    - [SLO vs SLA](#slo-vs-sla)
      - [SLA vs SLO vs SLI](#sla-vs-slo-vs-sli)
        - [**1. SLA (Service Level Agreement)**](#1-sla-service-level-agreement)
        - [**2. SLO (Service Level Objective)**](#2-slo-service-level-objective)
        - [**3. SLI (Service Level Indicator)**](#3-sli-service-level-indicator)
        - [Связь между терминами](#связь-между-терминами)
    - [1.4 Удобство сопровождения](#14-удобство-сопровождения)
      - [Удобство эксплуатации](#удобство-эксплуатации)
      - [Простота: регулируем сложность](#простота-регулируем-сложность)
      - [Возможность развития: облегчаем внесение изменений](#возможность-развития-облегчаем-внесение-изменений)
    - [1.5 Резюме](#15-резюме)


# Часть I – основы информационных систем
## Глава 1 – Надежные, масштабируемые и удобные в сопровождении приложения

Существуют три различных аспекта в проектировании масштабируемых системах:
1. Надежность (reliability)  система должна работать корректно, даже при неблагоприятных обстоятельствах (в случае аппаратных и программных сбоев, а также при ошибках пользователей)
2. Масштабируемость (scalability) – должны быть предусмотрены разумные способы решения при росте (объемов данных, трафике или сложности) системы проблем.
3. Удобство сопровождения (maintainability) – необходимо обеспечить возможность эффективной работы с системой множеству различных людей (разработчикам и прочим)

### 1.2 Надежность

Прежде всего нужно определиться с терминологией.

- Сбой (fault) – отклонение одного из компонентов системы от рабочих характеристик
- Отказ (failure) – вся система перестает предоставлять пользователю свои сервисы

Снизить вероятность сбоев до нуля невозможно. Однако можно увеличить устойчивость к сбоям, чтобы сбои не перетекали в отказы.

Парадоксально, но в подобных устойчивых к сбою системах имеет смысл повысить частоту сбоев с помощью умышленной их генерации с целью тестирования к устойчивости к отказам.
Например, с помощью сервиса Chaos Monkey от Netflix.

Существует два вида сбоев: аппаратный и программный.

#### Человеческий фактор

Существует исследование, где было доказано, что среди всех сбоев процент аппаратных сбоев составляет 10-25%.

Как системы могут застраховать себя от человеческого фактора?

1. Проектирование систем таким образом, который минимизировал бы возможность появление ошибок. Например, грамотно спроецированные абстракции, API и интерфейсы, которые бы **облегчили правильные действия и усложнили бы неправильные**.
2. Расцепить наиболее подверженные человеческим ошибкам с теми местами, где ошибки могут привести к отказам. Например, предоставить стейджинг среду, где разработчик может эксперементировать работу функционала с реальными данными без воздействия на пользователей.
3. Выполнять тщательное тестирование на всех уровнях – автоматизированное и ручное.
4. Обеспечить возможность быстрого и удобного восстановления после появления ошибок для минимизации последствий в случае отказа. Например, предоставить быструю возможность отката изменений.
5. Настроить подробный и ясный мониторинг, в том числе метрик производительности и частоты ошибок. Мониторинги и метрики позволяют предвидеть ошибки на их ранних стадиях появления.

### 1.3 Масштабируемость

Масштабируемость системы подразумевает то, сможет ли система выдержать более высокую нагрузку, чем была ранее. Например, от 10 тыс. запросов до 100 тыс. или от 1 миллиона до 10 миллионов.

#### Описание нагрузки

Во-первых нужно определить еденицу, параметр нагрузки. Это может быть:
- Количество запросов к веб-серверу
- Отношение количества операций чтения к операциям записи в БД
- Количество активных одновременно пользователей в комнате чата
- Частота успешных обращений в кеш
- Что-то другое

В случае с Twitter это будет распределение подписчиков на одного пользователя.

На текущий момент для знаменитостей в Twitter (более 30 млн подписчиков) использует слияние ленты пользователя и знаменитости.

#### Описание производительности

После описания нагрузки на систему, нужно выяснить, что произойдет при ее возрастании. Следует обратить внимание на два аспекта:
- Как изменится производительность системы, если увеличить параметры нагрузки при неизменных ресурсах системы?
- Насколько нужно увеличить ресурсы системы при увеличении параметра нагрузки, чтобы производительность системы не изменилась?

В системах пакетной обработки данных (Hadoop) нас обычно волнует **пропускная способность**. Есть два определения:
- количество записей, которые мы можем обработать в секунду
- общее время, необходимое для выполнения задания на наборе данных определенного размера

В онлайн системах важнее, как правило, **время ответа**.

##### latency (время ожидания) vs response time (время отклика)
- latency (время ожидания) – то, что видит клиент: помимо фактического времени обработки запроса, оно включает задержки при передаче информации по сети и задержки сообщений в очередях.
- response time (время отклика) – длительность ожидания запросом обработки, то есть время, на протяжении которого он ожидает обслуживания

Довольно часто смотрят именно на среднее время отклика. Однако удобнее применять перцентили.
Медиану обычно называют *p50*.

Тезисно:
- Медиану хорошо использовать, когда нужно узнать, сколько пользователям обычно приходится ждать: половина запросов пользователей обслуживается за время отклика меньше медианного, а оставшиеся обслуживаются более длительное время.
- Чтобы выяснить насколько плохи аномальные значения, можно обратить внимание на *p95*, *p99* и *p99.9*. Например, то, что время отклика для *p95* ровно 1.5 секунды означает следующее: 95 из 100 занимают менее 1.5 секунды, а 5 из 100 занимают 1.5 секунды или дольше.
- Верхние перцентили (*хвостовое время ожидания*) важны потому, что непосредственно оказывают влияние на опыт взаимодействия пользователя с сервисом. Например, в Amazon, пользователи с самыми медленными запросами зачастую имеют больше данных, чем остальные. Такое происходит, потому что те пользователи совершили большое число покупок. То есть они являются самыми ценными клиентами. Важно чтобы эти клиента оставались довольными. Исследование в Amazon гласит:
  - Рост времени отклика на 100ms снижает продажи на 1%
  - Замедление на 1s снижает удовлетворенность пользователей на 16%
- С другой стороны оптимизация по *99.9p* может оказаться дорогостоющей и не приносить достаточной выгоды.

### SLO vs SLA

Перцентили часто используют для подсчета *требования к уровню предоставления сервиса SLO (service level objectives)* и *соглашения об уровне предоставления SLA (service level agreements)*. Это контракты позволяющие оценить ожидаемый уровень производительности и доступности сервиса.


#### SLA vs SLO vs SLI
https://www.ninjaone.com/blog/sla-vs-slo-vs-sli/

##### **1. SLA (Service Level Agreement)**
Это официальный контракт между поставщиком услуг и клиентом. В нем описываются конкретные предоставляемые услуги, ожидаемые уровни производительности, приемлемые пороговые значения для этих показателей и последствия несоблюдения этих стандартов.
SLA обычно включает в себя:
- Описание услуги
- Показатели производительности: конкретные метрики, используемые для измерения производительности услуг
- Обязанности: четко определенные обязанности поставщика услуг и заказчика
- Штрафы и меры правовой защиты: последствия несоблюдения согласованных уровней обслуживания
- Отчетность и мониторинг

Пример: "Доступность сервиса должна составлять 99,9% в течение месяца. В случае нарушения клиент получает компенсацию."

##### **2. SLO (Service Level Objective)**
Это конкретная метрика или цель, установленная в рамках SLA или внутри компании для измерения качества услуги.
Ключевые аспекты:
- SLO – это цель, которой стремятся достичь в рамках SLA
- Определяет конкретные значения метрик (например, время отклика ≤ 200 ms)

Пример: "Система должна обрабатывать 95% запросов с задержкой не более 200 мс."

##### **3. SLI (Service Level Indicator)** 
Индикатор уровня обслуживания. Это конкретная измеряемая метрика, используемая для мониторинга и оценки производительности услуги.
Ключевые аспекты:
- SLI – это фактическое измерение, на основании которого оценивается выполнение SLO.
- Сырые данные, полученные из мониторинговых систем
- Обычно используется для контроля таких параметров, как latency, доступность и частота ошибок

Пример: "Фактическое время отклика сервиса составляет 180 ms (SLI), что соответствует целевому значению SLO ≤ 200 ms"

##### Связь между терминами
1. SLA — это формальное соглашение, включающее SLO, и определяющее последствия за его нарушение.
2. SLO — это цель или порог, который мы хотим достичь на основе SLI.
3. SLI — это измеряемая метрика (что происходит на самом деле).

Если случай подразумевает быстрорастущий сервис, то на практике, как правило, приходится пересматривать архитектуру по нескольку раз.

Зачастую проводят дифференциацию между *вертикальным масштабированием* – переходом на более мощную машину и *вертикальным масштабированием* – распределение нагрузки по нескольким меньшим машинам.
На практике хорошая архитектура обычно представляет собой смесь двух подходов.

Некоторые системы способны адаптироваться, то есть умеют автоматически добавлять вычислительную мощность при увеличении нагрузки.

### 1.4 Удобство сопровождения

Нужно проектировать систему так, чтобы максимально избежать сложностей при сопровождении. При проектировании следует принять во внимание три аспекта:
1. Удобство эксплуатации
2. Простота – облегчает понимание системы новым инженерам
3. Возможность развития – упрощает будущим разработчикам внесение изменений


#### Удобство эксплуатации

Означает облегчение выполнения стандартных задач, благодаря чему обслуживающий персонал сможет уделить больше внимания более важным задачам.

Удобство эксплуатации включает в себя:
- обеспечение хорошего мониторинга для облегчения понимания работы сервиса
- независимость от других машин
- качественная документация
- обеспечивает разумное поведение по умолчанию и позволяет переопределить настройки
- запускает самовосстановление по мере возможности
- демонстрирует предсказуемое поведение

#### Простота: регулируем сложность

Существуют различные симптомы сложного сервиса:
- скачкообразный рост пространства состояний
- тесное сцепление модулей
- запутанные зависимости
- несогласованные наименования и терминология
- костыли для решения проблем с производительностью
- выделение частных случаев для обхода проблем

Когда сложность достигает своего апогея, возникает превышение бюджета и срыв сроков. В сложном ПО увеличивается вероятность внесения ошибок. Поэтому простота должна быть основной целью создаваемых систем.

Один из лучших инструментов для исключения побочной сложности является абстракция. Абстракция позволяет скрыть сложную реализацию за понятным фасадом.

#### Возможность развития: облегчаем внесение изменений

Вероятность того, что системные требования навсегда останутся неизменными стремится к нулю. Гораздо вероятнее их преобразование.

Степень удобства модификации сервиса тесно связана с ее простотой и абстракциями: простую систему легче менять, чем сложные.

### 1.5 Резюме

Чтобы приносить пользу приложение должно соответствовать различным требованиям. Выделяют *функциональные требования* (что приложение должно делать, например обеспечивать возможность хранения данных) и некоторые *нефункциональные требования* (такие характеристики, как безопасность, надежность, соответствие нормативным документам, масштабируемость, совместимость и удобство сопровождения)



